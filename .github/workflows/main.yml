name: ðŸš€ Deploy Laravel App on Push

on:
  push:
    branches:
      - master

jobs:
  web-deploy:
    name: ðŸŽ‰ Deploy
    runs-on: ubuntu-latest

    steps:
    - name: ðŸšš Get latest code
      uses: actions/checkout@v4

    - name: Install Dependencies
      run: composer install --no-dev --prefer-dist --no-scripts

    - name: ðŸ“‚ Sync files to server
      uses: SamKirkland/FTP-Deploy-Action@v4.3.5
      with:
        server: 162.254.39.24
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        server-dir: /
        protocol: ftps # More secure than FTP
        passive: true  # Prevents connection issues
        timeout: 60000 # Increases timeout
        exclude: |
          vendor/**        # Prevents syncing vendor folder
          node_modules/**  # Prevents node_modules sync
          storage/**       # Prevents Laravel storage files from being uploaded
          .git/**          # Prevents Git files
          .env*            # Prevents all .env files (.env, .env.production, etc.)
          .gitignore       # Prevents .gitignore itself from being uploaded
          .phpunit.cache   # Prevents PHPUnit cache files
          /public/hot      # Prevents public/hot file
          /public/storage  # Prevents storage symlink from public
          /storage/*.key   # Prevents storage key files
          /storage/pail    # Prevents storage pail folder
          .phpactor.json   # Prevents PHPActor config
          .phpunit.result.cache # Prevents PHPUnit result cache
          Homestead.json   # Prevents Homestead files
          Homestead.yaml   # Prevents Homestead config
          npm-debug.log    # Prevents npm debug log
          yarn-error.log   # Prevents yarn error log
          auth.json        # Prevents auth.json
          /.fleet          # Prevents fleet folder
          /.idea           # Prevents PhpStorm/WebStorm IDE config files
          /.nova           # Prevents Laravel Nova config files
          /.vscode         # Prevents VS Code config files
          /.zed            # Prevents Zed editor config files
